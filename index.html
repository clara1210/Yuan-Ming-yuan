<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>åœ†æ˜å›­æ„ä»¶3Då±•ç¤º</title>
    
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family: Arial, sans-serif;background:#000;color:#fff;overflow-x:hidden;}
button{cursor:pointer;}

#techCanvas{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
z-index:-1;
}

#musicBtn,#lightBtn{
position:fixed;
right:20px;
padding:8px 12px;
border:none;
border-radius:6px;
background:#00ffff;
color:#000;
z-index:9999;
font-weight:bold;
}
#musicBtn{bottom:20px;}
#lightBtn{bottom:60px;}

#scanLine{
position:fixed;
top:0;
left:0;
width:100%;
height:4px;
background:linear-gradient(to right,transparent,#00ffff,transparent);
animation:scan 3s linear infinite;
}
@keyframes scan{
0%{top:0;}
100%{top:100%;}
}

#langBtn{
position:fixed;
top:20px;
right:20px;
padding:8px 14px;
border:none;
border-radius:6px;
background:#333;
color:#fff;
font-size:14px;
z-index:9999;
}

#selectPage{
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:30px;
}

.select-btn{
width:200px;
height:200px;
border:none;
border-radius:12px;
background-size:cover;
background-position:center;
}

#viewerPage{
display:none;
min-height:100vh;
flex-direction:column;
align-items:center;
padding:20px;
position:relative;
}

#backBtn{
position:fixed;
top:calc(20px + env(safe-area-inset-top));
left:20px;
padding:10px 20px;
font-size:16px;
border:none;
border-radius:6px;
background:#b8860b;
color:#fff;
font-weight:bold;
z-index:9999;
}

.model-container{
width:100%;
max-width:900px;
height:75vh;
border-radius:15px;
overflow:hidden;
position:relative;
margin-bottom:20px;
box-shadow:0 20px 40px rgba(0,0,0,0.2);
}

#modelCanvas{width:100%;height:100%;display:block;}

.introduction{
width:100%;
max-width:900px;
padding:30px;
text-align:center;
font-size:16px;
font-weight:bold;
background:rgba(255,255,255,0.95);
border-radius:15px;
line-height:1.7;
white-space:pre-line;
opacity:0;
transition:opacity 0.6s ease;
color:#333
}
.introduction.show{opacity:1;}

.controls,.part-buttons{
margin-top:20px;
display:flex;
gap:10px;
justify-content:center;
flex-wrap:wrap;
}

.control-btn,.part-btn{
padding:8px 16px;
border-radius:4px;
cursor:pointer;
}

.control-btn{border:none;background:#ffffff;}
.part-btn{background:#b8860b;border:none;color:#fff;font-weight:bold;}
</style>
</head>
<body>

<canvas id="techCanvas"></canvas>
<div id="scanLine"></div>

<audio id="bgm" loop>
<source src="https://cdn.pixabay.com/audio/2022/03/15/audio_7c1b5b1c8b.mp3" type="audio/mpeg">
</audio>

<button id="musicBtn">ğŸµ</button>
<button id="lightBtn">ğŸ’¡</button>

<button id="langBtn" onclick="toggleLanguage()">ä¸­æ–‡</button>

<div id="selectPage">
<button class="select-btn" id="horseBtn" onclick="startViewer('horse')" style="background-image:url('horsepicture.jpg')"></button>
<button class="select-btn" id="tigerBtn" onclick="startViewer('tiger')" style="background-image:url('tigerpicture.jpg')"></button>
</div>

<div id="viewerPage">
<button id="backBtn" onclick="returnToSelect()">è¿”å›é€‰æ‹©</button>

<div class="model-container">
<div id="loading">åŠ è½½ä¸­...</div>
<canvas id="modelCanvas"></canvas>
</div>

<div class="introduction" id="introText"></div>

<div class="controls">
<button class="control-btn" id="resetBtn" onclick="resetCamera()">é‡ç½®è§†è§’</button>
<button class="control-btn" id="zoomInBtn" onclick="zoomIn()">æ”¾å¤§</button>
<button class="control-btn" id="zoomOutBtn" onclick="zoomOut()">ç¼©å°</button>
</div>

<div class="part-buttons" id="partButtons"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>

<script>
let currentLang='zh';
let scene, camera, renderer, controls, model;
let autoRotate=true;
let currentModel='';
let modelScale=1;
const originalMaterials = new Map();
let speakOn=false;

// åˆ‡æ¢è¯­è¨€
function toggleLanguage(){
    currentLang = currentLang==='zh' ? 'en' : 'zh';
    document.getElementById('langBtn').innerText = currentLang==='zh' ? 'ä¸­æ–‡' : 'English';
    updateStaticText();
    if(currentModel) setupPartButtons();
    showIntroduction();
}

// æ›´æ–°æŒ‰é’®å’Œé™æ€æ–‡æœ¬
function updateStaticText(){
    document.getElementById('backBtn').innerText = currentLang==='zh'?'è¿”å›é€‰æ‹©':'Back';
    document.getElementById('resetBtn').innerText = currentLang==='zh'?'é‡ç½®è§†è§’':'Reset View';
    document.getElementById('zoomInBtn').innerText = currentLang==='zh'?'æ”¾å¤§':'Zoom In';
    document.getElementById('zoomOutBtn').innerText = currentLang==='zh'?'ç¼©å°':'Zoom Out';
    document.getElementById('loading').innerText = currentLang==='zh'?'åŠ è½½ä¸­...':'Loading...';
}

// é¡µé¢åˆ‡æ¢
function startViewer(type){
    currentModel = type;
    document.getElementById('selectPage').style.display='none';
    document.getElementById('viewerPage').style.display='flex';
    setupPartButtons();
    init();
    animate();
    showIntroduction();
}

function returnToSelect(){
    document.getElementById('viewerPage').style.display='none';
    document.getElementById('selectPage').style.display='flex';
    if(model) scene.remove(model);
    model=null;
}

// éƒ¨ä»¶æŒ‰é’®
function setupPartButtons(){
    const c=document.getElementById('partButtons');
    c.innerHTML='';
    if(currentModel==='horse'){
        c.innerHTML=currentLang==='zh'?
        `<button class="part-btn" onclick="showIntroduction('mane');highlightPart('mane')">é¬“æ¯›</button>
        <button class="part-btn" onclick="showIntroduction('ear');highlightPart('ear')">è€³æœµ</button>
        <button class="part-btn" onclick="showIntroduction('material');highlightPart('material')">æè´¨</button>
        <button class="part-btn" onclick="loadOldModel()">ä¿®å¤å‰çš„é©¬é¦–</button>
        <button class="part-btn" onclick="loadNewModel()">ä¿®å¤åçš„é©¬é¦–</button>`:
        `<button class="part-btn" onclick="showIntroduction('mane');highlightPart('mane')">Mane</button>
        <button class="part-btn" onclick="showIntroduction('ear');highlightPart('ear')">Ear</button>
        <button class="part-btn" onclick="showIntroduction('material');highlightPart('material')">Material</button>
        <button class="part-btn" onclick="loadOldModel()">Before Restoration</button>
        <button class="part-btn" onclick="loadNewModel()">After Restoration</button>`;
        modelScale=1;
    } else if(currentModel==='tiger'){
        c.innerHTML=currentLang==='zh'?
        `<button class="part-btn" onclick="showIntroduction('forehead');highlightPart('forehead')">å‰é¢</button>
        <button class="part-btn" onclick="showIntroduction('eyes');highlightPart('eyes')">çœ¼éƒ¨ç¥æ€</button>
        <button class="part-btn" onclick="showIntroduction('nose');highlightPart('nose')">é¼»éƒ¨ä¸é¢éƒ¨è‚Œè‚‰</button>
        <button class="part-btn" onclick="loadOldModel()">ä¿®å¤å‰çš„è™é¦–</button>
        <button class="part-btn" onclick="loadNewModel()">ä¿®å¤åçš„è™é¦–</button>`:
        `<button class="part-btn" onclick="showIntroduction('forehead');highlightPart('forehead')">Forehead</button>
        <button class="part-btn" onclick="showIntroduction('eyes');highlightPart('eyes')">Eyes</button>
        <button class="part-btn" onclick="showIntroduction('nose');highlightPart('nose')">Nose & Muscles</button>
        <button class="part-btn" onclick="loadOldModel()">Before Restoration</button>
        <button class="part-btn" onclick="loadNewModel()">After Restoration</button>`;
        modelScale=2;
    }
}

// ---------- æ¨¡å‹åŠ è½½ã€åŠ¨ç”»ã€ç¼©æ”¾ä¿æŒåŸæ · ----------
function init(){/*ä¿æŒåŸæ ·*/}  
function loadModel(url){/*ä¿æŒåŸæ ·*/}  
function loadOldModel(){/*ä¿æŒåŸæ ·*/}  
function loadNewModel(){/*ä¿æŒåŸæ ·*/}  
function animate(){/*ä¿æŒåŸæ ·*/}  
function onWindowResize(){/*ä¿æŒåŸæ ·*/}  
function resetCamera(){/*ä¿æŒåŸæ ·*/}  
function zoomIn(){/*ä¿æŒåŸæ ·*/}  
function zoomOut(){/*ä¿æŒåŸæ ·*/}  

// æ–‡å­—ä»‹ç»ï¼ˆä¿ç•™ä¸­æ–‡åŸæ–‡ï¼ŒåŒæ—¶æ·»åŠ è‹±æ–‡ï¼‰
function showIntroduction(part){
    const intro = document.getElementById('introText');
    intro.classList.remove('show');
    let text='';

    if(currentModel==='horse'){
        const content = {
            default: {
                zh: "å®ƒä¸åªæ˜¯ä¸€ä»¶æ–‡ç‰©ï¼Œæ›´æ˜¯ä¸€åº§â€œç™¾å¹´æ°´åŠ›é’Ÿâ€ï¼é©¬é¦–ä½œä¸ºæµ·æ™å ‚åäºŒç”Ÿè‚–æ°´åŠ›é’Ÿçš„æ ¸å¿ƒï¼Œä¸“é—¨å¯¹åº”åˆæ—¶ï¼ˆ11:00-13:00ï¼‰å–·æ°´ï¼Œä¸­è¥¿åˆç’§çš„æ°´åˆ©ä¸è®¡æ—¶æ™ºæ…§ï¼Œåœ¨å®ƒèº«ä¸Šä½“ç°å¾—æ·‹æ¼“å°½è‡´ã€‚",
                en: "It is not just an artifact, but a 'century-old hydraulic clock'! The horse head is the core of the Haiyantang Zodiac Water Clock, spraying water specifically at noon, perfectly blending Chinese and Western hydraulic timekeeping wisdom."
            },
            mane: {
                zh: "è¿™ç»„çµåŠ¨çš„å·æ›²é¬ƒæ¯›ï¼Œç«Ÿå‡ºè‡ªéƒä¸–å®ä¹‹æ‰‹ï¼å®ƒå°†è¥¿æ´‹é›•å¡‘çš„å†™å®ç»†è…»ï¼Œä¸ä¸­å›½é’é“œå·¥è‰ºçš„åšé‡å…¸é›…å®Œç¾èåˆï¼Œæ¯ä¸€ç¼•çº¹è·¯éƒ½è—ç€æ¸…ä»£å®«å»·é€ åŠå¤„çš„å·…å³°æŠ€è‰ºï¼Œå†ç»ç™¾å¹´ä¾æ—§çµåŠ¨é²œæ´»ã€‚",
                en: "These lively curled manes were crafted by Giuseppe Castiglione! They perfectly blend Western sculpture's realism with Chinese bronze's elegance, each strand reflecting the peak craftsmanship of the Qing imperial workshop, still vibrant after a century."
            },
            ear: {
                zh: "ä»”ç»†çœ‹ï¼è¿™å¤„æ®‹ç¼ºçš„å³è€³ï¼Œè—ç€ä¸€æ®µåˆ»éª¨é“­å¿ƒçš„å†å²â€”â€”1860å¹´è‹±æ³•è”å†›åŠ«æ åœ†æ˜å›­æ—¶ï¼Œå®ƒè¢«æš´åŠ›æŸæ¯ï¼Œæˆä¸ºæ–‡ç‰©ç™¾å¹´æµç¦»çš„â€œæ— å£°è§è¯è€…â€ã€‚ä»Šå¤©ï¼Œå°±è®©æˆ‘ä»¬ç”¨æ•°å­—æŠ€æœ¯ï¼Œä¸ºå®ƒè¡¥ä¸Šè¿™é“è·¨è¶Šç™¾å¹´çš„â€œä¼¤ç—•â€ã€‚",
                en: "Look closely! The damaged right ear carries a poignant historyâ€”looted during the 1860 Anglo-French expedition at Yuanmingyuan, it became a 'silent witness' of the artifact's century-long journey. Today, digital technology helps restore this century-old 'scar'."
            },
            material: {
                zh: "çœ‹ä¼¼æœ´ç´ çš„é©¬é¦–ï¼Œè—ç€ä¸ç®€å•çš„æè´¨å¯†ç â€”â€”å®ƒç”±98%é«˜çº¯åº¦çº¢é“œæ‰“é€ ï¼Œæ­é…å¾®é‡é“…ã€é“ã€é”Œï¼Œä¸ä¹¾éš†å†…åŠ¡åºœæ¡£æ¡ˆè®°è½½çš„é…æ–¹åˆ†æ¯«ä¸å·®ï¼Œä¹Ÿæ­£å› å¦‚æ­¤ï¼Œå®ƒæ‰èƒ½å†ç»ç™¾å¹´é£é›¨ï¼Œä¾æ—§å®Œå¥½ç•™å­˜ã€‚",
                en: "Seemingly simple, the horse head conceals a sophisticated material codeâ€”it is made of 98% high-purity red copper, with trace amounts of lead, iron, and zinc, exactly matching Qianlong's imperial workshop records, which is why it has endured intact for over a century."
            }
        };
        text = content[part || 'default'][currentLang];
    } else if(currentModel==='tiger'){
        const content = {
            default: {
                zh: "è™å¯¹åº”å¯…æ—¶ï¼ˆ3:00â€”5:00ï¼‰ï¼Œæ˜¯é»æ˜å°†è‡³ã€ä¸‡ç‰©è‹é†’ä¹‹æ—¶ã€‚è™é¦–æ¯åˆ°å¯…æ—¶è‡ªåŠ¨å–·æ°´ï¼Œæ­£åˆä¸åä¸€å…½é¦–é½å–·ï¼Œæ˜¯å¤äººæŠŠç”Ÿè‚–æ–‡åŒ–ã€è®¡æ—¶æ–‡åŒ–ã€æ°´åˆ©ç§‘æŠ€åˆä¸ºä¸€ä½“çš„ç»å¦™è®¾è®¡ã€‚",
                en: "The tiger corresponds to Yin hour (3:00â€“5:00), the time of dawn and awakening. The tiger head sprays water automatically at this time, together with the eleven other heads at noonâ€”a brilliant integration of Zodiac culture, timekeeping, and hydraulic technology."
            },
            forehead: {
                zh: "è™é¦–é¢å¤´ç‰¹æ„é“¸æœ‰æ¸…æ™°çš„ â€œç‹â€ å­—çº¹è·¯ ï¼Œè¿™æ˜¯ä¸­å›½æ–‡åŒ–ç‹¬æœ‰çš„è‰ºæœ¯è¡¨è¾¾ â€”â€” è™ä¸ºç™¾å…½ä¹‹ç‹ï¼Œâ€œç‹â€ å­—æ—¢æ˜¯è™çš„æ ‡å¿—ï¼Œä¹Ÿè±¡å¾å¨ä¸¥ã€æ­£æ°”ä¸å®ˆæŠ¤ï¼Œæ˜¯ä¸­å¼å›¾è…¾ä¸è¥¿æ–¹é›•å¡‘å®Œç¾èåˆçš„å·§æ€ã€‚",
                en: "The tiger's forehead bears a clear 'King' character, a unique expression of Chinese cultureâ€”the tiger, king of beasts. The 'King' symbol represents authority, righteousness, and protection, a clever fusion of Chinese totem and Western sculpture."
            },
            eyes: {
                zh: "è™é¦–åŒç›®åœ†çã€ç›®å…‰é”åˆ©æœ‰ç¥ï¼Œä¸æ€’è‡ªå¨ã€‚åœ¨ä¸­å›½æ–‡åŒ–é‡Œï¼Œè™çœ¼è±¡å¾å‹‡æ°”ã€é•‡å®…ã€è¾Ÿé‚ªï¼ŒåŒ å¸ˆç”¨æç®€çº¿æ¡ï¼Œå°±æŠŠçŒ›è™çš„ç²¾æ°”ç¥å®Œç¾å®šæ ¼ã€‚",
                en: "The tiger's eyes are wide and sharp, exuding natural authority. In Chinese culture, tiger eyes symbolize courage and protection. The craftsmen captured the tiger's spirit perfectly with minimalist lines."
            },
            nose: {
                zh: "è™é¦–é¼»æ¢æŒºæ‹¬ã€é¢éƒ¨è‚Œè‚‰é¥±æ»¡æœ‰åŠ›ï¼Œæ—¢éµå¾ªè¥¿æ–¹è§£å‰–å­¦çš„çœŸå®ç»“æ„ï¼Œåˆç¬¦åˆä¸œæ–¹å®¡ç¾é‡Œçš„é›„æµ‘å¤§æ°”ï¼Œæ¯ä¸€å¤„èµ·ä¼éƒ½ä½“ç°æ¸…ä»£å®«å»·é€ åŠå¤„çš„é¡¶çº§æ°´å‡†ã€‚",
                en: "The tiger's nose is prominent, facial muscles full and strong, following Western anatomical accuracy while reflecting Eastern aesthetic grandeur, each curve demonstrating Qing imperial workshop's top-level craftsmanship."
            }
        };
        text = content[part || 'default'][currentLang];
    }

    intro.textContent = text;
    intro.classList.add('show');

    if(speakOn){
        speakText(text);
    }
}

// éŸ³ä¹ä¸æœ—è¯»
const bgm=document.getElementById("bgm");
const musicBtn=document.getElementById("musicBtn");
musicBtn.onclick=function(){
    speakOn=!speakOn;
    if(speakOn){ bgm.play(); musicBtn.innerText="ğŸ”Š"; showIntroduction(); }
    else{ bgm.pause(); musicBtn.innerText="ğŸµ"; speechSynthesis.cancel(); }
}
function speakText(text){
    const utter=new SpeechSynthesisUtterance(text);
    utter.lang=currentLang==='zh'?'zh-CN':'en-US';
    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
}

// å±€éƒ¨é«˜äº®ã€ç²’å­èƒŒæ™¯ã€ç¯å…‰åˆ‡æ¢ä¿æŒåŸæ ·
function highlightPart(partName){/*ä¿æŒåŸæ ·*/}
const techCanvas=document.getElementById("techCanvas");
const ctx=techCanvas.getContext("2d");
techCanvas.width=window.innerWidth; techCanvas.height=window.innerHeight;
let particles=[];
for(let i=0;i<120;i++){particles.push({x:Math.random()*techCanvas.width,y:Math.random()*techCanvas.height,r:Math.random()*2,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5});}
function animateParticles(){
ctx.clearRect(0,0,techCanvas.width,techCanvas.height);
ctx.fillStyle="#00ffff";
particles.forEach(p=>{p.x+=p.dx;p.y+=p.dy;if(p.x<0||p.x>techCanvas.width)p.dx*=-1;if(p.y<0||p.y>techCanvas.height)p.dy*=-1;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fill();});
requestAnimationFrame(animateParticles);
}
animateParticles();
let cyberMode=true;
document.getElementById("lightBtn").onclick=function(){cyberMode=!cyberMode; scene.background=new THREE.Color(cyberMode?0x000000:0x222244);}
window.addEventListener("resize",()=>{techCanvas.width=window.innerWidth; techCanvas.height=window.innerHeight;});
</script>
</body>
</html>
