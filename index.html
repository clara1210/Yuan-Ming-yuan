<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>圆明园构件3D展示</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family: Arial, sans-serif;
    background:#ffffff;
}
.container{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:20px;
}
.model-container{
    width:100%;
    max-width:800px;
    height:70vh;
    border-radius:10px;
    overflow:hidden;
    position:relative;
    margin-bottom:20px;
}
#modelCanvas{
    width:100%;
    height:100%;
    display:block;
}
.loading{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:18px;
    color:#fff;
    z-index:10;
}
.introduction{
    width:100%;
    max-width:800px;
    padding:30px;
    text-align:center;
    font-size:16px;
    font-weight:bold;
    background:#f5f5f5;
    border-radius:10px;
    line-height:1.6;
    white-space:pre-line; /* 关键：保留换行 */
}
.controls,.part-buttons{
    margin-top:20px;
    display:flex;
    gap:10px;
    justify-content:center;
}
.control-btn,.part-btn{
    padding:8px 16px;
    border-radius:4px;
    cursor:pointer;
}
.control-btn{
    border:1px solid #ddd;
    background:#fff;
}
.control-btn:hover{background:#f0f0f0;}
.part-btn{
    background:#4CAF50;
    border:none;
    color:#fff;
    font-weight:bold;
}
.part-btn:hover{background:#45a049;}
</style>
</head>

<body>
<div class="container">

<div class="model-container">
<div class="loading" id="loading">加载中...</div>
<canvas id="modelCanvas"></canvas>
</div>

<div class="introduction" id="introText"></div>

<div class="controls">
<button class="control-btn" onclick="resetCamera()">重置视角</button>
<button class="control-btn" onclick="zoomIn()">放大</button>
<button class="control-btn" onclick="zoomOut()">缩小</button>
</div>

<div class="part-buttons">
<button class="part-btn" onclick="showIntroduction('mane')">鬓毛</button>
<button class="part-btn" onclick="showIntroduction('ear')">耳朵</button>
<button class="part-btn" onclick="showIntroduction('material')">材质</button>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>

<script>
let scene,camera,renderer,controls,model;
let raycaster=new THREE.Raycaster();
let mouse=new THREE.Vector2();

function init(){

scene=new THREE.Scene();

/* 背景 */
const textureLoader=new THREE.TextureLoader();
textureLoader.load('test1.jpg',function(texture){
    texture.encoding=THREE.sRGBEncoding;
    scene.background=texture;
});

/* 相机 */
camera=new THREE.PerspectiveCamera(75,1,0.1,1000);
camera.position.set(0,0,5);

/* 渲染器 */
const container=document.querySelector('.model-container');
renderer=new THREE.WebGLRenderer({
    canvas:document.getElementById('modelCanvas'),
    antialias:true
});
renderer.setPixelRatio(window.devicePixelRatio);
renderer.setSize(container.clientWidth,container.clientHeight);

/* 灯光 */
scene.add(new THREE.AmbientLight(0xffffff,0.6));
const dirLight=new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(2,2,2);
scene.add(dirLight);

/* 控制器 */
controls=new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping=true;
controls.enablePan=false;

/* 模型加载 */
const loader=new THREE.GLTFLoader();
loader.load('model.glb',function(gltf){

model=gltf.scene;
scene.add(model);

const box=new THREE.Box3().setFromObject(model);
const size=box.getSize(new THREE.Vector3());
const center=box.getCenter(new THREE.Vector3());
model.position.sub(center);

camera.position.z=Math.max(size.x,size.y,size.z)*3;

controls.target.set(0,0,0);
controls.update();

document.getElementById('loading').style.display='none';

},undefined,function(){
document.getElementById('loading').textContent='模型加载失败';
});

window.addEventListener('resize',onWindowResize);
}

function onWindowResize(){
const container=document.querySelector('.model-container');
camera.aspect=container.clientWidth/container.clientHeight;
camera.updateProjectionMatrix();
renderer.setSize(container.clientWidth,container.clientHeight);
}

function animate(){
requestAnimationFrame(animate);
controls.update();
renderer.render(scene,camera);
}

function resetCamera(){
camera.position.set(0,0,5);
controls.target.set(0,0,0);
controls.update();
}

function zoomIn(){camera.position.z*=0.8;}
function zoomOut(){camera.position.z*=1.2;}

function showIntroduction(part){
const intro=document.getElementById("introText");
let text=`它不只是一件文物，更是一座“百年水力钟”！
马首作为海晏堂十二生肖水力钟的核心，专门对应午时（11:00-13:00）喷水。
It is not just a cultural relic, but a century-old water clock!
As the centerpiece of the Twelve Zodiac Water Clock at Haiyan Hall, the Horse Head spouts water at the Wu hour (11:00–13:00).`;

if(part==='mane'){
text=`这组灵动的卷曲鬃毛出自郎世宁之手！
融合西洋写实与中国青铜工艺。
These lively curling manes blend Western realism with Chinese bronze craftsmanship.`;
}

if(part==='ear'){
text=`残缺的右耳见证1860年历史。
The damaged right ear witnessed the 1860 looting of Yuanmingyuan.`;
}

if(part==='material'){
text=`马首由98%高纯度红铜铸造。
Forged from 98% high-purity copper.`;
}

intro.textContent=text;
}

init();
animate();
showIntroduction(); // 默认文字
</script>

</body>
</html>
