<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>åœ†æ˜å›­æ„ä»¶3Då±•ç¤º</title>
    
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family: Arial, sans-serif;background:#000;color:#fff;overflow-x:hidden;}
button{cursor:pointer;}

#techCanvas{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
z-index:-1;
}

#hudPanel{
position:fixed;
left:20px;
bottom:20px;
background:rgba(0,255,255,0.1);
border:1px solid #00ffff;
padding:15px;
border-radius:10px;
font-size:13px;
backdrop-filter:blur(5px);
}

#musicBtn,#lightBtn{
position:fixed;
right:20px;
padding:8px 12px;
border:none;
border-radius:6px;
background:#00ffff;
color:#000;
z-index:9999;
font-weight:bold;
}
#musicBtn{bottom:20px;}
#lightBtn{bottom:60px;}

#scanLine{
position:fixed;
top:0;
left:0;
width:100%;
height:4px;
background:linear-gradient(to right,transparent,#00ffff,transparent);
animation:scan 3s linear infinite;
}
@keyframes scan{
0%{top:0;}
100%{top:100%;}
}

#langBtn{
position:fixed;
top:20px;
right:20px;
padding:8px 14px;
border:none;
border-radius:6px;
background:#333;
color:#fff;
font-size:14px;
z-index:9999;
}

#selectPage{
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:30px;
}

.select-btn{
padding:0;
border:none;
border-radius:12px;
background:none;
cursor:pointer;
transition:0.3s;
}
.select-btn img{
width:200px;
height:auto;
border-radius:12px;
}
.select-btn:hover img{opacity:0.8;}

#viewerPage{
display:none;
min-height:100vh;
flex-direction:column;
align-items:center;
padding:20px;
position:relative;
}

#backBtn{
position:fixed;
top:calc(20px + env(safe-area-inset-top));
left:20px;
padding:10px 20px;
font-size:16px;
border:none;
border-radius:6px;
background:#b8860b;
color:#fff;
font-weight:bold;
z-index:9999;
}

.model-container{
width:100%;
max-width:900px;
height:75vh;
border-radius:15px;
overflow:hidden;
position:relative;
margin-bottom:20px;
box-shadow:0 20px 40px rgba(0,0,0,0.2);
background-size:cover;
background-position:center;
}

#modelCanvas{width:100%;height:100%;display:block;}

.introduction{
width:100%;
max-width:900px;
padding:30px;
text-align:center;
font-size:16px;
font-weight:bold;
background:rgba(255,255,255,0.95);
border-radius:15px;
line-height:1.7;
white-space:pre-line;
opacity:0;
transition:opacity 0.6s ease;
color:#333;
}
.introduction.show{opacity:1;}

.controls,.part-buttons{
margin-top:20px;
display:flex;
gap:10px;
justify-content:center;
flex-wrap:wrap;
}

.control-btn,.part-btn{
padding:8px 16px;
border-radius:4px;
cursor:pointer;
}

.control-btn{border:none;background:#ffffff;}
.part-btn{background:#b8860b;border:none;color:#fff;font-weight:bold;}
</style>
</head>
<body>

<canvas id="techCanvas"></canvas>
<div id="scanLine"></div>

<audio id="bgm" loop>
<source src="https://cdn.pixabay.com/audio/2022/03/15/audio_7c1b5b1c8b.mp3" type="audio/mpeg">
</audio>

<button id="musicBtn">ğŸµ</button>
<button id="lightBtn">ğŸ’¡</button>
    
<button id="langBtn" onclick="toggleLanguage()">
ä¸­æ–‡
</button>

<div id="selectPage">
<button class="select-btn" id="horseBtn" onclick="startViewer('horse')">
<img src="horsepicture.jpg" alt="é©¬é¦–">
</button>
<button class="select-btn" id="tigerBtn" onclick="startViewer('tiger')">
<img src="tigerpicture.jpg" alt="è™é¦–">
</button>
</div>

<div id="viewerPage">
<button id="backBtn" onclick="returnToSelect()">è¿”å›é€‰æ‹©</button>

<div class="model-container" id="modelContainer">
<div id="loading">åŠ è½½ä¸­...</div>
<canvas id="modelCanvas"></canvas>
</div>

<div class="introduction" id="introText"></div>

<div class="controls">
<button class="control-btn" id="resetBtn" onclick="resetCamera()">é‡ç½®è§†è§’</button>
<button class="control-btn" id="zoomInBtn" onclick="zoomIn()">æ”¾å¤§</button>
<button class="control-btn" id="zoomOutBtn" onclick="zoomOut()">ç¼©å°</button>
</div>

<div class="part-buttons" id="partButtons"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>

<script>
let currentLang='zh';
let scene, camera, renderer, controls, model;
let autoRotate=true;
let currentModel='';
let modelScale=1;

function toggleLanguage(){
    currentLang = currentLang==='zh'?'en':'zh';
    document.getElementById('langBtn').innerText=currentLang==='zh'?'ä¸­æ–‡':'English';
    updateStaticText();
    if(currentModel) setupPartButtons();
    showIntroduction();
}

function updateStaticText(){
    document.getElementById('backBtn').innerText=currentLang==='zh'?'è¿”å›é€‰æ‹©':'Back';
    document.getElementById('resetBtn').innerText=currentLang==='zh'?'é‡ç½®è§†è§’':'Reset View';
    document.getElementById('zoomInBtn').innerText=currentLang==='zh'?'æ”¾å¤§':'Zoom In';
    document.getElementById('zoomOutBtn').innerText=currentLang==='zh'?'ç¼©å°':'Zoom Out';
    document.getElementById('loading').innerText=currentLang==='zh'?'åŠ è½½ä¸­...':'Loading...';
}

function startViewer(type){
    currentModel = type;
    document.getElementById('selectPage').style.display='none';
    document.getElementById('viewerPage').style.display='flex';
    setupPartButtons();
    init();
    animate();
    showIntroduction();
}

function returnToSelect(){
    document.getElementById('viewerPage').style.display='none';
    document.getElementById('selectPage').style.display='flex';
    if(model) scene.remove(model);
    model=null;
}

function setupPartButtons(){
    const c=document.getElementById('partButtons');
    c.innerHTML='';
    if(currentModel==='horse'){
        c.innerHTML=currentLang==='zh'?`
<button class="part-btn" onclick="showIntroduction('mane')">é¬“æ¯›</button>
<button class="part-btn" onclick="showIntroduction('ear')">è€³æœµ</button>
<button class="part-btn" onclick="showIntroduction('material')">æè´¨</button>
<button class="part-btn" onclick="loadOldModel()">ä¿®å¤å‰çš„é©¬é¦–</button>
<button class="part-btn" onclick="loadNewModel()">ä¿®å¤åçš„é©¬é¦–</button>`:
`
<button class="part-btn" onclick="showIntroduction('mane')">Mane</button>
<button class="part-btn" onclick="showIntroduction('ear')">Ear</button>
<button class="part-btn" onclick="showIntroduction('material')">Material</button>
<button class="part-btn" onclick="loadOldModel()">Before Restoration</button>
<button class="part-btn" onclick="loadNewModel()">After Restoration</button>`;
        modelScale=1;
    } else if(currentModel==='tiger'){
        c.innerHTML=currentLang==='zh'?`
<button class="part-btn" onclick="showIntroduction('forehead')">å‰é¢</button>
<button class="part-btn" onclick="showIntroduction('eyes')">çœ¼éƒ¨ç¥æ€</button>
<button class="part-btn" onclick="showIntroduction('nose')">é¼»éƒ¨ä¸é¢éƒ¨è‚Œè‚‰</button>
<button class="part-btn" onclick="loadOldModel()">ä¿®å¤å‰çš„è™é¦–</button>
<button class="part-btn" onclick="loadNewModel()">ä¿®å¤åçš„è™é¦–</button>`:
`
<button class="part-btn" onclick="showIntroduction('forehead')">Forehead</button>
<button class="part-btn" onclick="showIntroduction('eyes')">Eyes</button>
<button class="part-btn" onclick="showIntroduction('nose')">Nose & Muscles</button>
<button class="part-btn" onclick="loadOldModel()">Before Restoration</button>
<button class="part-btn" onclick="loadNewModel()">After Restoration</button>`;
        modelScale=2;
    }
}

function init(){
    scene = new THREE.Scene();
    scene.background = new THREE.TextureLoader().load('back.jpg'); // èƒŒæ™¯å›¾ç‰‡
    scene.fog = new THREE.Fog(0x111111,15,70);

    camera = new THREE.PerspectiveCamera(60,1,0.1,1000);
    camera.position.set(0,1,6);

    const container = document.querySelector('.model-container');
    renderer = new THREE.WebGLRenderer({
        canvas: document.getElementById('modelCanvas'),
        antialias:true,
        alpha:true
    });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(container.clientWidth, container.clientHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;

    // ç¯å…‰
    const ambientLight = new THREE.AmbientLight(0xffffff,0.4);
    scene.add(ambientLight);
    const spotLight = new THREE.SpotLight(0xffffff,0.8);
    spotLight.position.set(5,10,5);
    spotLight.castShadow = true;
    spotLight.shadow.mapSize.width = 2048;
    spotLight.shadow.mapSize.height = 2048;
    spotLight.angle = Math.PI/6;
    scene.add(spotLight);
    const frontLight = new THREE.DirectionalLight(0xffffff,1.2);
    frontLight.position.set(0,3,6);
    scene.add(frontLight);
    const sideLight = new THREE.DirectionalLight(0xffffff,0.6);
    sideLight.position.set(-5,3,2);
    scene.add(sideLight);
    const backLight = new THREE.DirectionalLight(0xffffff,0.4);
    backLight.position.set(0,3,-6);
    scene.add(backLight);

    const groundGeo = new THREE.PlaneGeometry(20,20);
    const groundMat = new THREE.ShadowMaterial({opacity:0.25});
    const ground = new THREE.Mesh(groundGeo,groundMat);
    ground.rotation.x=-Math.PI/2;
    ground.position.y=-1.5;
    ground.receiveShadow = true;
    scene.add(ground);

    controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.enablePan = false;
    controls.addEventListener('start',()=>autoRotate=false);
    controls.addEventListener('end',()=>autoRotate=true);

    if(currentModel==='horse') loadModel('horse model.glb');
    else if(currentModel==='tiger') loadModel('tiger model.glb');

    window.addEventListener('resize', onWindowResize);
}

// ä»¥ä¸‹ loadModelã€animateã€resetCameraã€zoomInã€zoomOut ä¿æŒåŸæ ·
// ===== éŸ³ä¹æ§åˆ¶ =====
const bgm=document.getElementById("bgm");
const musicBtn=document.getElementById("musicBtn");
let musicOn=false;
musicBtn.onclick=function(){
if(!musicOn){bgm.play();musicBtn.innerText="ğŸ”Š";}
else{bgm.pause();musicBtn.innerText="ğŸµ";}
musicOn=!musicOn;
}

// ===== è¯­éŸ³è®²è§£ =====
function speakText(text){
const utter=new SpeechSynthesisUtterance(text);
utter.lang=currentLang==='zh'?'zh-CN':'en-US';
speechSynthesis.cancel();
speechSynthesis.speak(utter);
}

// ===== showIntroduction =====
function showIntroduction(part){
    const intro = document.getElementById('introText');
    intro.classList.remove('show');
    let text='';

    if(currentModel==='horse'){
        if(currentLang==='zh'){
            text=`å®ƒä¸åªæ˜¯ä¸€ä»¶æ–‡ç‰©ï¼Œæ›´æ˜¯ä¸€åº§â€œç™¾å¹´æ°´åŠ›é’Ÿâ€ï¼é©¬é¦–ä½œä¸ºæµ·æ™å ‚åäºŒç”Ÿè‚–æ°´åŠ›é’Ÿçš„æ ¸å¿ƒï¼Œä¸“é—¨å¯¹åº”åˆæ—¶ï¼ˆ11:00-13:00ï¼‰å–·æ°´ï¼Œä¸­è¥¿åˆç’§çš„æ°´åˆ©ä¸è®¡æ—¶æ™ºæ…§ï¼Œåœ¨å®ƒèº«ä¸Šä½“ç°å¾—æ·‹æ¼“å°½è‡´ã€‚`;
            if(part==='mane') text=`è¿™ç»„çµåŠ¨çš„å·æ›²é¬ƒæ¯›ï¼Œç«Ÿå‡ºè‡ªéƒä¸–å®ä¹‹æ‰‹ï¼å®ƒå°†è¥¿æ´‹é›•å¡‘çš„å†™å®ç»†è…»ï¼Œä¸ä¸­å›½é’é“œå·¥è‰ºçš„åšé‡å…¸é›…å®Œç¾èåˆï¼Œæ¯ä¸€ç¼•çº¹è·¯éƒ½è—ç€æ¸…ä»£å®«å»·é€ åŠå¤„çš„å·…å³°æŠ€è‰ºï¼Œå†ç»ç™¾å¹´ä¾æ—§çµåŠ¨é²œæ´»ã€‚`;
            if(part==='ear') text=`ä»”ç»†çœ‹ï¼è¿™å¤„æ®‹ç¼ºçš„å³è€³ï¼Œè—ç€ä¸€æ®µåˆ»éª¨é“­å¿ƒçš„å†å²â€”â€”1860å¹´è‹±æ³•è”å†›åŠ«æ åœ†æ˜å›­æ—¶ï¼Œå®ƒè¢«æš´åŠ›æŸæ¯ï¼Œæˆä¸ºæ–‡ç‰©ç™¾å¹´æµç¦»çš„â€œæ— å£°è§è¯è€…â€ã€‚ä»Šå¤©ï¼Œå°±è®©æˆ‘ä»¬ç”¨æ•°å­—æŠ€æœ¯ï¼Œä¸ºå®ƒè¡¥ä¸Šè¿™é“è·¨è¶Šç™¾å¹´çš„â€œä¼¤ç—•â€ã€‚`;
            if(part==='material') text=`çœ‹ä¼¼æœ´ç´ çš„é©¬é¦–ï¼Œè—ç€ä¸ç®€å•çš„æè´¨å¯†ç â€”â€”å®ƒç”±98%é«˜çº¯åº¦çº¢é“œæ‰“é€ ï¼Œæ­é…å¾®é‡é“…ã€é“ã€é”Œï¼Œä¸ä¹¾éš†å†…åŠ¡åºœæ¡£æ¡ˆè®°è½½çš„é…æ–¹åˆ†æ¯«ä¸å·®ï¼Œä¹Ÿæ­£å› å¦‚æ­¤ï¼Œå®ƒæ‰èƒ½å†ç»ç™¾å¹´é£é›¨ï¼Œä¾æ—§å®Œå¥½ç•™å­˜ã€‚`;
        } else {
            text=`It is not just a cultural relic, but a century-old water clock!
As the centerpiece of the Twelve Chinese Zodiac Water Clock at the Haiyan Hall, the Horse Head spouts water specifically at the Wu hour (11:00â€“13:00).
The wisdom of water conservancy and timekeeping, a perfect fusion of Chinese and Western ingenuity, is vividly embodied in it.`;
            if(part==='mane') text=`These lively, curling manes are actually the work of Giuseppe Castiglione! They perfectly blend the realistic delicacy of Western sculpture with the solemn elegance of Chinese bronze craftsmanship. 
Every strand and pattern bears the supreme skill of the Qing court workshops, remaining vivid and vibrant even after a hundred years.`;
            if(part==='ear') text=`Look closely! This damaged right ear holds a deeply unforgettable history.
In 1860, during the looting of the Old Summer Palace by Anglo-French forces, it was violently destroyed, becoming a silent witness to the relicâ€™s century of displacement.
Today, let us use digital technology to mend this century-old scar.`;
            if(part==='material') text=`The seemingly simple Horse Head hides an extraordinary material secret.
Forged from 98% high-purity copper, with trace amounts of lead, iron, and zinc, its composition matches exactly the formula recorded in the archives of the Qianlong Imperial Household Department.
This is precisely why it has survived centuries of wind and rain and remained intact to this day.`;
        }
    } else if(currentModel==='tiger'){
        if(currentLang==='zh'){
            text=`è™å¯¹åº”å¯…æ—¶ï¼ˆ3:00â€”5:00ï¼‰ï¼Œæ˜¯é»æ˜å°†è‡³ã€ä¸‡ç‰©è‹é†’ä¹‹æ—¶ã€‚è™é¦–æ¯åˆ°å¯…æ—¶è‡ªåŠ¨å–·æ°´ï¼Œæ­£åˆä¸åä¸€å…½é¦–é½å–·ï¼Œæ˜¯å¤äººæŠŠç”Ÿè‚–æ–‡åŒ–ã€è®¡æ—¶æ–‡åŒ–ã€æ°´åˆ©ç§‘æŠ€åˆä¸ºä¸€ä½“çš„ç»å¦™è®¾è®¡ã€‚`;
            if(part==='forehead') text=`è™é¦–é¢å¤´ç‰¹æ„é“¸æœ‰æ¸…æ™°çš„ â€œç‹â€ å­—çº¹è·¯ ï¼Œè¿™æ˜¯ä¸­å›½æ–‡åŒ–ç‹¬æœ‰çš„è‰ºæœ¯è¡¨è¾¾ â€”â€” è™ä¸ºç™¾å…½ä¹‹ç‹ï¼Œâ€œç‹â€ å­—æ—¢æ˜¯è™çš„æ ‡å¿—ï¼Œä¹Ÿè±¡å¾å¨ä¸¥ã€æ­£æ°”ä¸å®ˆæŠ¤ï¼Œæ˜¯ä¸­å¼å›¾è…¾ä¸è¥¿æ–¹é›•å¡‘å®Œç¾èåˆçš„å·§æ€ã€‚`;
            if(part==='eyes') text=`è™é¦–åŒç›®åœ†çã€ç›®å…‰é”åˆ©æœ‰ç¥ï¼Œä¸æ€’è‡ªå¨ã€‚åœ¨ä¸­å›½æ–‡åŒ–é‡Œï¼Œè™çœ¼è±¡å¾å‹‡æ°”ã€é•‡å®…ã€è¾Ÿé‚ªï¼ŒåŒ å¸ˆç”¨æç®€çº¿æ¡ï¼Œå°±æŠŠçŒ›è™çš„ç²¾æ°”ç¥å®Œç¾å®šæ ¼ã€‚`;
            if(part==='nose') text=`è™é¦–é¼»æ¢æŒºæ‹¬ã€é¢éƒ¨è‚Œè‚‰é¥±æ»¡æœ‰åŠ›ï¼Œæ—¢éµå¾ªè¥¿æ–¹è§£å‰–å­¦çš„çœŸå®ç»“æ„ï¼Œåˆç¬¦åˆä¸œæ–¹å®¡ç¾é‡Œçš„é›„æµ‘å¤§æ°”ï¼Œæ¯ä¸€å¤„èµ·ä¼éƒ½ä½“ç°æ¸…ä»£å®«å»·é€ åŠå¤„çš„é¡¶çº§æ°´å‡†ã€‚`;
        } else {
            text=`The Tiger corresponds to the Yin hour (3:00â€“5:00), the time when dawn approaches and all living things stir.
The Tiger Head automatically spouts water at every Yin hour, and at noon, it sprays in unison with the other eleven animal heads.
This is an ingenious design by the ancient Chinese that integrates zodiac culture, timekeeping culture, and water conservancy technology.`;
            if(part==='forehead') text=`The forehead of the Tiger Head is specially cast with a distinct Chinese character "ç‹" (wÃ¡ng, meaning "king") patternâ€”a unique artistic expression in Chinese culture.
As the king of all beasts, the tiger bears the character "ç‹" as its symbol. It represents dignity, righteousness, and protection, embodying the ingenious fusion of Chinese totem art and Western sculpture.`;
            if(part==='eyes') text=`The Tiger Head has wide-open, sharp and vivid eyes, exuding awe without anger.
In Chinese culture, tiger eyes symbolize courage, home protection, and warding off evil spirits.
With minimal lines, the craftsmen perfectly captured the spirit and vigor of the mighty tiger.`;
            if(part==='nose') text=`The Tiger Headâ€™s nose bridge is prominent, with full and powerful facial muscles.
It follows Western anatomical realism while adhering to the grandeur and majesty of Eastern aesthetics.
Every curve and detail showcases the top-level craftsmanship of the Qing Imperial Workshop.`;
        }
    }

    intro.innerText = text;
    intro.classList.add('show');
    speakText(text);
}
</script>
</body>
</html>
