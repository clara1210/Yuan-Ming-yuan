<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>åœ†æ˜å›­æ„ä»¶3Då±•ç¤º</title>
    
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family: Arial, sans-serif;background:#000;color:#fff;overflow-x:hidden;}
button{cursor:pointer;}

#techCanvas{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
z-index:-1;
}

#musicBtn,#lightBtn{
position:fixed;
right:20px;
padding:8px 12px;
border:none;
border-radius:6px;
background:#00ffff;
color:#000;
z-index:9999;
font-weight:bold;
}
#musicBtn{bottom:20px;}
#lightBtn{bottom:60px;}

#scanLine{
position:fixed;
top:0;
left:0;
width:100%;
height:4px;
background:linear-gradient(to right,transparent,#00ffff,transparent);
animation:scan 3s linear infinite;
}
@keyframes scan{
0%{top:0;}
100%{top:100%;}
}

#langBtn{
position:fixed;
top:20px;
right:20px;
padding:8px 14px;
border:none;
border-radius:6px;
background:#333;
color:#fff;
font-size:14px;
z-index:9999;
}

#selectPage{
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:30px;
}

.select-btn{
width:200px;
height:200px;
border:none;
border-radius:12px;
background-size:cover;
background-position:center;
}

#viewerPage{
display:none;
min-height:100vh;
flex-direction:column;
align-items:center;
padding:20px;
position:relative;
}

#backBtn{
position:fixed;
top:calc(20px + env(safe-area-inset-top));
left:20px;
padding:10px 20px;
font-size:16px;
border:none;
border-radius:6px;
background:#b8860b;
color:#fff;
font-weight:bold;
z-index:9999;
}

.model-container{
width:100%;
max-width:900px;
height:75vh;
border-radius:15px;
overflow:hidden;
position:relative;
margin-bottom:20px;
box-shadow:0 20px 40px rgba(0,0,0,0.2);
}

#modelCanvas{width:100%;height:100%;display:block;}

.introduction{
width:100%;
max-width:900px;
padding:30px;
text-align:center;
font-size:16px;
font-weight:bold;
background:rgba(255,255,255,0.95);
border-radius:15px;
line-height:1.7;
white-space:pre-line;
opacity:0;
transition:opacity 0.6s ease;
color:#333
}
.introduction.show{opacity:1;}

.controls,.part-buttons{
margin-top:20px;
display:flex;
gap:10px;
justify-content:center;
flex-wrap:wrap;
}

.control-btn,.part-btn{
padding:8px 16px;
border-radius:4px;
cursor:pointer;
}

.control-btn{border:none;background:#ffffff;}
.part-btn{background:#b8860b;border:none;color:#fff;font-weight:bold;}
</style>
</head>
<body>

<canvas id="techCanvas"></canvas>
<div id="scanLine"></div>

<audio id="bgm" loop>
<source src="https://cdn.pixabay.com/audio/2022/03/15/audio_7c1b5b1c8b.mp3" type="audio/mpeg">
</audio>

<button id="musicBtn">ğŸµ</button>
<button id="lightBtn">ğŸ’¡</button>

<button id="langBtn" onclick="toggleLanguage()">ä¸­æ–‡</button>

<div id="selectPage">
<button class="select-btn" id="horseBtn" onclick="startViewer('horse')" style="background-image:url('horsepicture.jpg')"></button>
<button class="select-btn" id="tigerBtn" onclick="startViewer('tiger')" style="background-image:url('tigerpicture.jpg')"></button>
</div>

<div id="viewerPage">
<button id="backBtn" onclick="returnToSelect()">è¿”å›é€‰æ‹©</button>

<div class="model-container">
<div id="loading">åŠ è½½ä¸­...</div>
<canvas id="modelCanvas"></canvas>
</div>

<div class="introduction" id="introText"></div>

<div class="controls">
<button class="control-btn" id="resetBtn" onclick="resetCamera()">é‡ç½®è§†è§’</button>
<button class="control-btn" id="zoomInBtn" onclick="zoomIn()">æ”¾å¤§</button>
<button class="control-btn" id="zoomOutBtn" onclick="zoomOut()">ç¼©å°</button>
</div>

<div class="part-buttons" id="partButtons"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>

<script>
let currentLang='zh';
let scene, camera, renderer, controls, model;
let autoRotate=true;
let currentModel='';
let modelScale=1;
const originalMaterials = new Map();

// æœ—è¯»å¼€å…³
let speakOn=false;

function toggleLanguage(){
    currentLang = currentLang==='zh' ? 'en' : 'zh';
    document.getElementById('langBtn').innerText = currentLang==='zh' ? 'ä¸­æ–‡' : 'English';
    updateStaticText();
    if(currentModel) setupPartButtons();
    showIntroduction();
}

function updateStaticText(){
    document.getElementById('backBtn').innerText = currentLang==='zh'?'è¿”å›é€‰æ‹©':'Back';
    document.getElementById('resetBtn').innerText = currentLang==='zh'?'é‡ç½®è§†è§’':'Reset View';
    document.getElementById('zoomInBtn').innerText = currentLang==='zh'?'æ”¾å¤§':'Zoom In';
    document.getElementById('zoomOutBtn').innerText = currentLang==='zh'?'ç¼©å°':'Zoom Out';
    document.getElementById('loading').innerText = currentLang==='zh'?'åŠ è½½ä¸­...':'Loading...';
}

function startViewer(type){
    currentModel = type;
    document.getElementById('selectPage').style.display='none';
    document.getElementById('viewerPage').style.display='flex';
    setupPartButtons();
    init();
    animate();
    showIntroduction();
}

function returnToSelect(){
    document.getElementById('viewerPage').style.display='none';
    document.getElementById('selectPage').style.display='flex';
    if(model) scene.remove(model);
    model=null;
}

function setupPartButtons(){
    const c=document.getElementById('partButtons');
    c.innerHTML='';
    if(currentModel==='horse'){
        c.innerHTML=currentLang==='zh'?
        `<button class="part-btn" onclick="showIntroduction('mane');highlightPart('mane')">é¬“æ¯›</button>
        <button class="part-btn" onclick="showIntroduction('ear');highlightPart('ear')">è€³æœµ</button>
        <button class="part-btn" onclick="showIntroduction('material');highlightPart('material')">æè´¨</button>
        <button class="part-btn" onclick="loadOldModel()">ä¿®å¤å‰</button>
        <button class="part-btn" onclick="loadNewModel()">ä¿®å¤å</button>`:
        `<button class="part-btn" onclick="showIntroduction('mane');highlightPart('mane')">Mane</button>
        <button class="part-btn" onclick="showIntroduction('ear');highlightPart('ear')">Ear</button>
        <button class="part-btn" onclick="showIntroduction('material');highlightPart('material')">Material</button>
        <button class="part-btn" onclick="loadOldModel()">Before</button>
        <button class="part-btn" onclick="loadNewModel()">After</button>`;
        modelScale=1;
    } else if(currentModel==='tiger'){
        c.innerHTML=currentLang==='zh'?
        `<button class="part-btn" onclick="showIntroduction('forehead');highlightPart('forehead')">å‰é¢</button>
        <button class="part-btn" onclick="showIntroduction('eyes');highlightPart('eyes')">çœ¼éƒ¨</button>
        <button class="part-btn" onclick="showIntroduction('nose');highlightPart('nose')">é¼»éƒ¨</button>
        <button class="part-btn" onclick="loadOldModel()">ä¿®å¤å‰</button>
        <button class="part-btn" onclick="loadNewModel()">ä¿®å¤å</button>`:
        `<button class="part-btn" onclick="showIntroduction('forehead');highlightPart('forehead')">Forehead</button>
        <button class="part-btn" onclick="showIntroduction('eyes');highlightPart('eyes')">Eyes</button>
        <button class="part-btn" onclick="showIntroduction('nose');highlightPart('nose')">Nose</button>
        <button class="part-btn" onclick="loadOldModel()">Before</button>
        <button class="part-btn" onclick="loadNewModel()">After</button>`;
        modelScale=2;
    }
}

// ---------- åˆå§‹åŒ–ã€åŠ è½½æ¨¡å‹ã€åŠ¨ç”»ç­‰ä¿æŒåŸæ · ----------
function init(){/*çœç•¥ï¼Œä¿æŒå’ŒåŸæ¥ä¸€è‡´*/}  
function loadModel(url){/*çœç•¥ï¼Œä¿æŒå’ŒåŸæ¥ä¸€è‡´*/}  
function loadOldModel(){/*çœç•¥ï¼Œä¿æŒå’ŒåŸæ¥ä¸€è‡´*/}  
function loadNewModel(){/*çœç•¥ï¼Œä¿æŒå’ŒåŸæ¥ä¸€è‡´*/}  
function animate(){/*çœç•¥ï¼Œä¿æŒå’ŒåŸæ¥ä¸€è‡´*/}  
function onWindowResize(){/*çœç•¥*/}  
function resetCamera(){/*çœç•¥*/}  
function zoomIn(){/*çœç•¥*/}  
function zoomOut(){/*çœç•¥*/}  

// æ–‡å­—ä»‹ç»ï¼ˆä¸­è‹±æ–‡å¯¹åº”ï¼‰
function showIntroduction(part){
    const intro = document.getElementById('introText');
    intro.classList.remove('show');
    let text='';

    if(currentModel==='horse'){
        const content = {
            default: {
                zh: "é©¬é¦–ï¼Œæµ·æ™å ‚åäºŒç”Ÿè‚–æ°´åŠ›é’Ÿæ ¸å¿ƒï¼Œä½“ç°ä¸­è¥¿æ°´åˆ©è®¡æ—¶æ™ºæ…§ã€‚",
                en: "Horse head, the core of the Haiyantang Zodiac Water Clock, showcases Chinese-Western hydraulic timekeeping."
            },
            mane: {
                zh: "å·æ›²é¬ƒæ¯›ï¼Œèåˆè¥¿æ´‹é›•å¡‘ä¸ä¸­å›½é’é“œå·¥è‰ºã€‚",
                en: "Curled mane blending Western sculpture with Chinese bronze craftsmanship."
            },
            ear: {
                zh: "å³è€³æ®‹ç¼ºï¼Œæ˜¯åœ†æ˜å›­å†å²çš„è§è¯ã€‚",
                en: "Right ear damaged, a witness to the history of Yuanmingyuan."
            },
            material: {
                zh: "ç”±é«˜çº¯åº¦çº¢é“œæ‰“é€ ï¼Œå†ç»ç™¾å¹´ä»å®Œå¥½ã€‚",
                en: "Made of high-purity red copper, perfectly preserved for over a century."
            }
        };
        text = content[part || 'default'][currentLang];
    } else if(currentModel==='tiger'){
        const content = {
            default: {
                zh: "è™é¦–å¯¹åº”å¯…æ—¶ï¼Œè‡ªåŠ¨å–·æ°´ï¼Œèåˆç”Ÿè‚–æ–‡åŒ–ä¸æ°´åˆ©ç§‘æŠ€ã€‚",
                en: "Tiger head corresponds to Yin hour, sprays water automatically, blending Zodiac culture with hydraulic tech."
            },
            forehead: {
                zh: "é¢å¤´åˆ»â€œç‹â€å­—ï¼Œè±¡å¾å¨ä¸¥ä¸å®ˆæŠ¤ã€‚",
                en: "Forehead engraved with 'King', symbolizing authority and protection."
            },
            eyes: {
                zh: "çœ¼ç›åœ†çï¼Œç›®å…‰é”åˆ©è±¡å¾å‹‡æ°”ä¸é•‡å®…ã€‚",
                en: "Eyes wide and sharp, symbolizing courage and protection."
            },
            nose: {
                zh: "é¼»æ¢æŒºæ‹¬ï¼Œé¢éƒ¨è‚Œè‚‰é¥±æ»¡ï¼Œä½“ç°é¡¶çº§å·¥è‰ºã€‚",
                en: "Nose prominent, facial muscles strong, showcasing masterful craftsmanship."
            }
        };
        text = content[part || 'default'][currentLang];
    }

    intro.textContent = text;
    intro.classList.add('show');

    if(speakOn){
        speakText(text);
    }
}

// éŸ³ä¹ä¸æœ—è¯»
const bgm=document.getElementById("bgm");
const musicBtn=document.getElementById("musicBtn");
musicBtn.onclick=function(){
    speakOn=!speakOn;
    if(speakOn){ bgm.play(); musicBtn.innerText="ğŸ”Š"; showIntroduction(); }
    else{ bgm.pause(); musicBtn.innerText="ğŸµ"; speechSynthesis.cancel(); }
}
function speakText(text){
    const utter=new SpeechSynthesisUtterance(text);
    utter.lang=currentLang==='zh'?'zh-CN':'en-US';
    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
}

// å±€éƒ¨é«˜äº® & ç²’å­èƒŒæ™¯ & ç¯å…‰åˆ‡æ¢ä¿æŒåŸæ ·
function highlightPart(partName){/*çœç•¥*/}
const techCanvas=document.getElementById("techCanvas");
const ctx=techCanvas.getContext("2d");
techCanvas.width=window.innerWidth; techCanvas.height=window.innerHeight;
let particles=[];
for(let i=0;i<120;i++){particles.push({x:Math.random()*techCanvas.width,y:Math.random()*techCanvas.height,r:Math.random()*2,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5});}
function animateParticles(){
ctx.clearRect(0,0,techCanvas.width,techCanvas.height);
ctx.fillStyle="#00ffff";
particles.forEach(p=>{p.x+=p.dx;p.y+=p.dy;if(p.x<0||p.x>techCanvas.width)p.dx*=-1;if(p.y<0||p.y>techCanvas.height)p.dy*=-1;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fill();});
requestAnimationFrame(animateParticles);
}
animateParticles();
let cyberMode=true;
document.getElementById("lightBtn").onclick=function(){cyberMode=!cyberMode; scene.background=new THREE.Color(cyberMode?0x000000:0x222244);}
window.addEventListener("resize",()=>{techCanvas.width=window.innerWidth; techCanvas.height=window.innerHeight;});
</script>
</body>
</html>
