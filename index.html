<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>圆明园3D展示</title>
    <style>
        body { margin: 0; background: #000; }
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="loading">加载中...</div>
    <!-- 用最旧的稳定版本，完全避免兼容性问题 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/loaders/GLTFLoader.js"></script>
    <script>
        window.onload = function() {
            // 场景
            var scene = new THREE.Scene();
            // 相机
            var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            // 渲染器
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // 加载模型
            var loader = new THREE.GLTFLoader();
            var loadingText = document.querySelector('.loading');
            
            loader.load(
                'https://raw.githubusercontent.com/clara1210/Yuan-Ming-yuan/main/3d%20model.glb',
                function (gltf) {
                    scene.add(gltf.scene);
                    loadingText.style.display = 'none';
                },
                function (xhr) {
                    console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );
                },
                function (error) {
                    console.error('An error happened', error);
                    loadingText.innerText = '加载失败';
                }
            );

            // 相机位置
            camera.position.z = 5;

            // 渲染循环
            function animate() {
                requestAnimationFrame(animate);
                renderer.render(scene, camera);
            }
            animate();

            // 窗口适配
            window.addEventListener('resize', function() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        };
    </script>
</body>
</html>
