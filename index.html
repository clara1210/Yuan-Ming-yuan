<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>圆明园构件3D展示</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family: Arial, sans-serif;
    background:#f0f0f0; /* 改为纯浅灰背景 */
}
.container{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:20px;
}
.model-container{
    width:100%;
    max-width:900px;
    height:75vh;
    border-radius:20px;
    overflow:hidden;
    position:relative;
    margin-bottom:20px;
    box-shadow:0 25px 50px rgba(0,0,0,0.15);
    background:transparent;
}
#modelCanvas{
    width:100%;
    height:100%;
    display:block;
}
.loading{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:18px;
    color:#666;
    z-index:10;
}
.introduction{
    width:100%;
    max-width:900px;
    padding:30px;
    text-align:center;
    font-size:16px;
    font-weight:bold;
    background:rgba(255,255,255,0.95);
    border-radius:15px;
    line-height:1.7;
    white-space:pre-line;
    opacity:0;
    transition:opacity 0.6s ease;
    box-shadow:0 15px 30px rgba(0,0,0,0.08);
}
.introduction.show{
    opacity:1;
}
.controls,.part-buttons{
    margin-top:20px;
    display:flex;
    gap:10px;
    justify-content:center;
}
.control-btn,.part-btn{
    padding:8px 16px;
    border-radius:6px;
    cursor:pointer;
}
.control-btn{
    border:none;
    background:#ffffff;
    box-shadow:0 4px 10px rgba(0,0,0,0.08);
}
.part-btn{
    background:#b8860b;
    border:none;
    color:#fff;
    font-weight:bold;
}
.part-btn:hover{background:#d4af37;}
</style>
</head>

<body>
<div class="container">

<div class="model-container">
<div class="loading" id="loading">加载中...</div>
<canvas id="modelCanvas"></canvas>
</div>

<div class="introduction" id="introText"></div>

<div class="controls">
<button class="control-btn" onclick="resetCamera()">重置视角</button>
<button class="control-btn" onclick="zoomIn()">放大</button>
<button class="control-btn" onclick="zoomOut()">缩小</button>
</div>

<div class="part-buttons">
<button class="part-btn" onclick="showIntroduction('mane')">鬓毛</button>
<button class="part-btn" onclick="showIntroduction('ear')">耳朵</button>
<button class="part-btn" onclick="showIntroduction('material')">材质</button>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>

<script>
let scene,camera,renderer,controls,model;
let autoRotate=true;

function init(){

scene=new THREE.Scene();

/* 修改为浅灰纯色背景 */
scene.background=new THREE.Color(0xf0f0f0);

/* 相机 */
camera=new THREE.PerspectiveCamera(50,1,0.1,1000);
camera.position.set(0,1.2,5);

/* 渲染器 */
const container=document.querySelector('.model-container');
renderer=new THREE.WebGLRenderer({
    canvas:document.getElementById('modelCanvas'),
    antialias:true
});
renderer.shadowMap.enabled=true;
renderer.shadowMap.type=THREE.PCFSoftShadowMap;
renderer.setPixelRatio(window.devicePixelRatio);
renderer.setSize(container.clientWidth,container.clientHeight);

/* 灯光 */
scene.add(new THREE.AmbientLight(0xffffff,0.6));

const dirLight=new THREE.DirectionalLight(0xffffff,1);
dirLight.position.set(3,6,4);
dirLight.castShadow=true;
dirLight.shadow.mapSize.width=2048;
dirLight.shadow.mapSize.height=2048;
dirLight.shadow.radius=4;
scene.add(dirLight);

const fillLight=new THREE.DirectionalLight(0xffffff,0.3);
fillLight.position.set(-3,2,-4);
scene.add(fillLight);

/* 地面 */
const ground=new THREE.Mesh(
    new THREE.PlaneGeometry(20,20),
    new THREE.MeshStandardMaterial({color:0xf0f0f0})
);
ground.rotation.x=-Math.PI/2;
ground.position.y=-1.3;
ground.receiveShadow=true;
scene.add(ground);

/* 控制器 */
controls=new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping=true;
controls.enablePan=false;
controls.addEventListener('start',()=>autoRotate=false);
controls.addEventListener('end',()=>autoRotate=true);

/* 模型 */
const loader=new THREE.GLTFLoader();
loader.load('model.glb',function(gltf){

model=gltf.scene;
model.traverse(obj=>{
if(obj.isMesh){
obj.castShadow=true;
obj.receiveShadow=false;
}
});
scene.add(model);

const box=new THREE.Box3().setFromObject(model);
const center=box.getCenter(new THREE.Vector3());
model.position.sub(center);

document.getElementById('loading').style.display='none';

});

window.addEventListener('resize',onWindowResize);
}

function animate(){
requestAnimationFrame(animate);
if(model && autoRotate){
model.rotation.y+=0.003;
}
controls.update();
renderer.render(scene,camera);
}

function onWindowResize(){
const container=document.querySelector('.model-container');
camera.aspect=container.clientWidth/container.clientHeight;
camera.updateProjectionMatrix();
renderer.setSize(container.clientWidth,container.clientHeight);
}

function resetCamera(){
camera.position.set(0,1.2,5);
controls.target.set(0,0,0);
controls.update();
}
function zoomIn(){camera.position.z*=0.85;}
function zoomOut(){camera.position.z*=1.15;}

init();
animate();
</script>

</body>
</html>
